<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>Alessio's Portofolio</title>
        <style>
            * {
                padding: 0px;
                margin: 0px;
            }
        </style>
    </head>
    <body>
        <script>
            let worldSize = 9600;
            let defaultPlayerSize = 75;
            let x = worldSize / 2;
            let y = worldSize / 2;
            let tickId = null;

            class Player {
                constructor(posX, posY, size, map) {
                    this.size = size;
                    this.posX = posX - this.size / 2;
                    this.posY = posY - this.size / 2;
                    this.speed = 3;
                    this.ctx = map.getContext("2d");
                    this.ctx.fillStyle = "blue";

                    this.up = false;
                    this.left = false;
                    this.right = false;
                    this.down = false;
                }

                placeNow() {
                    this.ctx.fillRect(
                        this.posX,
                        this.posY,
                        this.size,
                        this.size
                    );
                }
                place(a, b, c, d) {
                    this.ctx.fillRect(a, b, c, d);
                }

                remove() {
                    this.ctx.clearRect(
                        this.posX - 1,
                        this.posY - 1,
                        this.size + 2,
                        this.size + 1
                    );
                }

                render() {
                    // console.log(this.down)
                    this.remove()
                    if (this.up) {
                        this.posY -= this.speed;
                    }
                    if (this.left) {
                        this.posX -= this.speed;
                    }
                    if (this.right) {
                        this.posX += this.speed;
                    }
                    if (this.down) {
                        this.posY += this.speed;
                    }
                    this.placeNow();
                    // this.render();
                }
            }

            class OverWorld {
                constructor() {
                    this.map = document.createElement("canvas");

                    this.map.width = worldSize;
                    this.map.height = worldSize;
                    this.map.style.cssText = `
                        display: block;
                        background-color: #eee;
                        overflow: hidden;
                    `;
                }
                buildMap() {
                    document.querySelector("body").append(this.map);
                }
            }

            var ow = new OverWorld();
            var p = new Player(x, y, defaultPlayerSize, ow.map);
            ow.buildMap();

            function tick() {
                p.render();
            }

            clearInterval(tickId);
            tickId = setInterval(tick, 32);
            p.placeNow();

            // var ctx = main.getContext("2d");
            // ctx.fillStyle = "blue";
            // ctx.fillRect(x, y, pSize, pSize);

            // function renderPlayer() {
            //     ctx.beginPath();
            //     ctx.rect(x, y, pSize, pSize);
            //     ctx.fillStyle = "#0095DD";
            //     ctx.fill();
            //     ctx.closePath();
            //     setTimeout(() => {
            //         refreshPlayer();
            //     }, 16);
            // }

            // function refreshPlayer(direction) {
            //     ctx.clearRect(x - 1, y - 1, x + pSize + 1, y + pSize + 1);
            //     x += dx;
            //     y += dy;
            //     renderPlayer();
            // }

            // var ctx2 = main.getContext("2d");
            // ctx2.fillStyle = "#0095DD";
            // ctx2.fillRect(x2, y2, pSize, pSize);
            // function renderPlayer2() {

            // ctx2.fillRect(x2, y2, pSize, pSize);
            //     setTimeout(() => {
            //         refreshPlayer2();
            //     }, 16);
            // }
            // // function refreshPlayer2() {
            // //     ctx2.clearRect(x2 - 1, y2 - 1, x2 + pSize + 1, y2 + pSize + 1);
            // //     x2 += dx2;
            // //     y2 += dy2;
            // //     renderPlayer2();
            // // }

            document.onkeydown = function (event) {
                if (event.keyCode === 87) {
                    p.up = true;
                }
                if (event.keyCode === 65) {
                    p.left = true;
                }
                if (event.keyCode === 83) {
                    p.down = true;
                }
                if (event.keyCode === 68) {
                    p.right = true;
                }
            };

            document.onkeyup = function (event) {
                if (event.keyCode === 87) {
                    p.up = false;
                }
                if (event.keyCode === 65) {
                    p.left = false;
                }
                if (event.keyCode === 83) {
                    p.down = false;
                }
                if (event.keyCode === 68) {
                    p.right = false;
                }
            };
            ow.map.onclick = function (e) {
                // calculatePos();
                // renderPlayer();
                // renderPlayer2();
                p.place(e.x - p.size / 2, e.y - p.size / 2, p.size, p.size);
                document.documentElement.scrollLeft = x - 800;
                document.documentElement.scrollTop = y-800;
                // console.log("scroll location:", window.scrollX, window.scrollY);
                console.log("mouse location:", e.x, e.y, "\nup:", p.up);
                p.remove();
            };
            // function scroll(x, y) {
            //     window.scrollTo(x, y);
            // }

            // function calculatePos() {
            //     console.log(x);
            // }
            // document.addEventListener("keydown", (event) => {
            //     console.log(event)
            // });
        </script>
    </body>
</html>
